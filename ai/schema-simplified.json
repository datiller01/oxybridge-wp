{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://oxybridge.dev/ai/schema-simplified.json",
  "title": "OxyBridge AI Simplified Schema",
  "description": "Simplified schema for AI-driven page generation with OxyBridge REST API, including class management and common patterns",
  "version": "1.1.0",
  "type": "object",

  "classManagement": {
    "title": "CSS Class Management",
    "description": "Documentation for managing CSS classes on elements through the OxyBridge REST API",

    "classProperties": {
      "className": {
        "title": "Element className",
        "description": "The className property specifies custom CSS classes applied to an element. Multiple classes are space-separated. Stored at properties.attributes.className in the element tree.",
        "type": "string",
        "pattern": "^[a-zA-Z_-][a-zA-Z0-9_- ]*$",
        "examples": [
          "my-custom-class",
          "hero-section highlighted",
          "btn btn-primary btn-lg"
        ],
        "storagePaths": [
          "data.properties.attributes.className",
          "data.properties.className",
          "data.properties.settings.attributes.customCssClass"
        ]
      },
      "additionalClasses": {
        "title": "Element additionalClasses",
        "description": "Built-in classes defined by the element type. These are read-only and automatically added by the element. Common prefixes: bde-, breakdance-, ee-, oxy-",
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "description": "The CSS class name"
            },
            "template": {
              "type": "string",
              "description": "Template condition for class application (e.g., 'yes' for always)"
            }
          }
        },
        "examples": [
          [{"name": "breakdance-link", "template": "yes"}],
          [{"name": "bde-button", "template": "yes"}]
        ]
      }
    },

    "builtInClassPrefixes": {
      "description": "CSS class prefixes used by built-in elements (read-only)",
      "prefixes": {
        "bde-": "Breakdance element classes (e.g., bde-button, bde-heading)",
        "breakdance-": "Breakdance utility classes (e.g., breakdance-link)",
        "ee-": "Essential Elements classes",
        "oxy-": "Oxygen Builder classes",
        "ct-": "Core template classes"
      }
    },

    "endpoints": {
      "getClasses": {
        "method": "GET",
        "path": "/oxybridge/v1/documents/{id}/classes",
        "description": "Get all CSS classes from elements in a document",
        "parameters": {
          "id": {
            "type": "integer",
            "required": true,
            "description": "Post/document ID"
          },
          "element_id": {
            "type": "string",
            "required": false,
            "description": "Filter by specific element ID"
          }
        },
        "response": {
          "type": "object",
          "properties": {
            "post_id": "integer",
            "elements": {
              "type": "array",
              "items": {
                "id": "string - Element ID",
                "type": "string - Element type (e.g., EssentialElements\\Button)",
                "classes": "array - All classes (custom + built-in)",
                "custom_classes": "array - User-defined classes only",
                "builtin_classes": "array - Element's built-in classes"
              }
            },
            "summary": {
              "total_elements": "integer",
              "unique_classes": "array",
              "total_class_count": "integer"
            }
          }
        },
        "example": {
          "request": "GET /oxybridge/v1/documents/280/classes",
          "response": {
            "post_id": 280,
            "elements": [
              {
                "id": "hero-button",
                "type": "EssentialElements\\Button",
                "classes": ["bde-button", "btn-primary", "animated"],
                "custom_classes": ["btn-primary", "animated"],
                "builtin_classes": ["bde-button"]
              }
            ],
            "summary": {
              "total_elements": 1,
              "unique_classes": ["bde-button", "btn-primary", "animated"],
              "total_class_count": 3
            }
          }
        }
      },

      "updateClasses": {
        "method": "PUT",
        "path": "/oxybridge/v1/documents/{id}/elements/{element_id}/classes",
        "description": "Set/update CSS classes on a specific element",
        "parameters": {
          "id": {
            "type": "integer",
            "required": true,
            "description": "Post/document ID"
          },
          "element_id": {
            "type": "string",
            "required": true,
            "description": "Element ID within the document"
          },
          "classes": {
            "type": "array",
            "required": true,
            "description": "Array of CSS class names to set",
            "validation": "Must match pattern: ^[a-zA-Z_-][a-zA-Z0-9_-]*$"
          },
          "regenerate_css": {
            "type": "boolean",
            "default": true,
            "description": "Regenerate CSS cache after save"
          }
        },
        "example": {
          "request": {
            "method": "PUT",
            "url": "/oxybridge/v1/documents/280/elements/hero-button/classes",
            "body": {
              "classes": ["btn-primary", "btn-lg", "animated"]
            }
          },
          "response": {
            "success": true,
            "post_id": 280,
            "element_id": "hero-button",
            "classes": ["btn-primary", "btn-lg", "animated"],
            "element": {
              "id": "hero-button",
              "type": "EssentialElements\\Button"
            }
          }
        }
      },

      "deleteClass": {
        "method": "DELETE",
        "path": "/oxybridge/v1/documents/{id}/elements/{element_id}/classes/{class_name}",
        "description": "Remove a specific CSS class from an element",
        "parameters": {
          "id": {
            "type": "integer",
            "required": true,
            "description": "Post/document ID"
          },
          "element_id": {
            "type": "string",
            "required": true,
            "description": "Element ID within the document"
          },
          "class_name": {
            "type": "string",
            "required": true,
            "description": "CSS class name to remove"
          },
          "regenerate_css": {
            "type": "boolean",
            "default": true,
            "description": "Regenerate CSS cache after save"
          }
        },
        "example": {
          "request": "DELETE /oxybridge/v1/documents/280/elements/hero-button/classes/animated",
          "response": {
            "success": true,
            "post_id": 280,
            "element_id": "hero-button",
            "removed_class": "animated",
            "classes": ["btn-primary", "btn-lg"]
          }
        },
        "notes": [
          "Cannot remove built-in classes (bde-, breakdance-, ee-, oxy- prefixed)",
          "Returns 404 if class not found on element"
        ]
      }
    },

    "classValidation": {
      "description": "Rules for valid CSS class names",
      "pattern": "^[a-zA-Z_-][a-zA-Z0-9_-]*$",
      "rules": [
        "Must start with a letter, underscore, or hyphen",
        "Can contain letters, numbers, underscores, and hyphens",
        "Cannot start with a digit",
        "Cannot contain spaces (use separate array items)",
        "Case-sensitive"
      ],
      "validExamples": [
        "my-class",
        "MyClass",
        "_private",
        "-modifier",
        "btn-primary-lg"
      ],
      "invalidExamples": [
        "123class",
        "my class",
        "class.name",
        "class@special"
      ]
    }
  },

  "elementTypes": {
    "title": "Common Element Types",
    "description": "Reference for element types and their built-in classes",
    "elements": {
      "EssentialElements\\Section": {
        "className": "bde-section",
        "description": "Page section container"
      },
      "EssentialElements\\Div": {
        "className": "bde-div",
        "description": "Generic div container"
      },
      "EssentialElements\\Heading": {
        "className": "bde-heading",
        "description": "Heading element (h1-h6)"
      },
      "EssentialElements\\Text": {
        "className": "bde-text",
        "description": "Text/paragraph element"
      },
      "EssentialElements\\Button": {
        "className": "bde-button",
        "description": "Button element"
      },
      "EssentialElements\\TextLink": {
        "className": "breakdance-link",
        "description": "Text link element",
        "additionalClasses": [{"name": "breakdance-link", "template": "yes"}]
      },
      "EssentialElements\\Link": {
        "className": "breakdance-link",
        "description": "Link element (alias for TextLink)",
        "additionalClasses": [{"name": "breakdance-link", "template": "yes"}]
      },
      "EssentialElements\\Image2": {
        "className": "bde-image",
        "description": "Image element"
      },
      "EssentialElements\\Container": {
        "className": "bde-container",
        "description": "Container element"
      },
      "EssentialElements\\Columns": {
        "className": "bde-columns",
        "description": "Column layout container"
      },
      "EssentialElements\\Column": {
        "className": "bde-column",
        "description": "Individual column"
      }
    }
  },

  "usagePatterns": {
    "addClassToElement": {
      "title": "Add a Custom Class to an Element",
      "steps": [
        "1. GET the document classes to find the element and its current classes",
        "2. Prepare the new class list (existing + new classes)",
        "3. PUT the updated classes to the element"
      ],
      "example": {
        "description": "Add 'highlighted' class to an element that has 'btn-primary'",
        "step1": "GET /oxybridge/v1/documents/280/classes?element_id=hero-button",
        "step2": "Combine existing ['btn-primary'] with new ['highlighted']",
        "step3": {
          "method": "PUT",
          "url": "/oxybridge/v1/documents/280/elements/hero-button/classes",
          "body": {"classes": ["btn-primary", "highlighted"]}
        }
      }
    },
    "toggleClass": {
      "title": "Toggle a Class On/Off",
      "steps": [
        "1. GET current classes for the element",
        "2. Check if class exists in custom_classes",
        "3. If exists: remove it using DELETE endpoint",
        "4. If not exists: add it using PUT endpoint with merged list"
      ]
    },
    "bulkClassUpdate": {
      "title": "Update Multiple Elements' Classes",
      "note": "Make individual PUT requests per element. No bulk endpoint currently available."
    }
  }
}
